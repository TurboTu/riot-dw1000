<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sys/net/gnrc/transport_layer/tcp/gnrc_tcp_pkt.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="riot-logo.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">DecaRange RTLS ARM Application</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a408b6d3a4a484720bc3ecfeac8947e3.html">sys</a></li><li class="navelem"><a class="el" href="dir_8029da4437d789f4711f6586d7ee68bf.html">net</a></li><li class="navelem"><a class="el" href="dir_3441f3001dd6ccd78cd6b9a576f26623.html">gnrc</a></li><li class="navelem"><a class="el" href="dir_0727303dbfc59bd8e335280ddc9d2cf1.html">transport_layer</a></li><li class="navelem"><a class="el" href="dir_d99edc6487248bf918b7b8209db2fc3e.html">tcp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">gnrc_tcp_pkt.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="gnrc__tcp__pkt_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (C) 2015 Simon Brummer</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * This file is subject to the terms and conditions of the GNU Lesser</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * General Public License v2.1. See the file LICENSE in the top level</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * directory for more details.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="stdlib_8h.html">stdlib.h</a>&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="utlist_8h.html">utlist.h</a>&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="errno_8h.html">errno.h</a>&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="msg_8h.html">msg.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="inet__csum_8h.html">net/inet_csum.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pktbuf_8h.html">net/gnrc/pktbuf.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gnrc_2tcp_8h.html">net/gnrc/tcp.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="net_2gnrc_2transport__layer_2tcp_2internal_2pkt_8h.html">internal/pkt.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="net_2gnrc_2transport__layer_2tcp_2internal_2helper_8h.html">internal/helper.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="option_8h.html">internal/option.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="eventloop_8h.html">internal/eventloop.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="gnrc__tcp__pkt_8c.html#a432138093c53d7580af9ec5c5dca387f">   31</a></span>&#160;<span class="preprocessor">#define ENABLE_DEBUG (0)</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="debug_8h.html">debug.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* Check if a sequence number, falls into the receive window */</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="gnrc__tcp__pkt_8c.html#a7aee945a11ee7207709773ae03ba0e1c">   35</a></span>&#160;<span class="preprocessor">#define INSIDE_WND(l_ed, seq_num, r_ed) (LEQ_32_BIT(l_ed, seq_num) &amp;&amp; LSS_32_BIT(seq_num, r_ed))</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> uint32_t _max(<span class="keyword">const</span> uint32_t x, <span class="keyword">const</span> uint32_t y)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">return</span> (x &gt; y) ? x : y;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="group__net__gnrc__tcp.html#gad9390ed91a77ee5dbdc0b12a757112a2">   50</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__net__gnrc__tcp.html#gad9390ed91a77ee5dbdc0b12a757112a2">_pkt_build_reset_from_pkt</a>(<a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> **out_pkt, <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *in_pkt)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="group__net__gnrc__tcp.html#ga6feb29b23e0b703c41bb3f4546b6e03a">tcp_hdr_t</a> tcp_hdr_out;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">/* Extract headers */</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *tcp_snp;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="group__sys__ut.html#ga8c5c97079c5b259e4c0ff7c563b0f8ed">LL_SEARCH_SCALAR</a>(in_pkt, tcp_snp, <a class="code" href="multiboot_8h.html#a8da1a8c7127a0371eec0810a29e30f3c">type</a>, GNRC_NETTYPE_TCP);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="group__net__gnrc__tcp.html#ga6feb29b23e0b703c41bb3f4546b6e03a">tcp_hdr_t</a> *tcp_hdr_in = (<a class="code" href="group__net__gnrc__tcp.html#ga6feb29b23e0b703c41bb3f4546b6e03a">tcp_hdr_t</a> *)tcp_snp-&gt;<a class="code" href="structgnrc__pktsnip.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;#ifdef MODULE_GNRC_IPV6</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *ip6_snp;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="group__sys__ut.html#ga8c5c97079c5b259e4c0ff7c563b0f8ed">LL_SEARCH_SCALAR</a>(in_pkt, ip6_snp, <a class="code" href="multiboot_8h.html#a8da1a8c7127a0371eec0810a29e30f3c">type</a>, GNRC_NETTYPE_IPV6);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="group__net__ipv6__hdr.html#ga0846d585b3470fba8677f853cec37c23">ipv6_hdr_t</a> *ip6_hdr = (<a class="code" href="group__net__ipv6__hdr.html#ga0846d585b3470fba8677f853cec37c23">ipv6_hdr_t</a> *)ip6_snp-&gt;data;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;#endif</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">/* Setup Header information */</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    tcp_hdr_out.src_port = tcp_hdr_in-&gt;dst_port;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    tcp_hdr_out.dst_port = tcp_hdr_in-&gt;src_port;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    tcp_hdr_out.checksum = byteorder_htons(0);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    tcp_hdr_out.window = byteorder_htons(0);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    tcp_hdr_out.urgent_ptr = byteorder_htons(0);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">/* Seq/Ackno and control flags depend on inputs ACK-Flag */</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    uint16_t ctl = byteorder_ntohs(tcp_hdr_in-&gt;off_ctl);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">if</span> (ctl &amp; <a class="code" href="group__net__gnrc__tcp.html#gae0be310c4b4a33195a478e7318390782">MSK_ACK</a>) {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        tcp_hdr_out.off_ctl = byteorder_htons((<a class="code" href="group__net__gnrc__tcp.html#ga2629e70587f04d0329a72d40f7f15bdb">OPTION_OFFSET_BASE</a> &lt;&lt; 12) | <a class="code" href="group__net__gnrc__tcp.html#ga5f7f251fc046204e1af584ce646b29f7">MSK_RST</a>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        tcp_hdr_out.seq_num = tcp_hdr_in-&gt;ack_num;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        tcp_hdr_out.ack_num = byteorder_htonl(0);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        uint8_t seq_no = 0;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        tcp_hdr_out.off_ctl = byteorder_htons((<a class="code" href="group__net__gnrc__tcp.html#ga2629e70587f04d0329a72d40f7f15bdb">OPTION_OFFSET_BASE</a> &lt;&lt; 12) | <a class="code" href="group__net__gnrc__tcp.html#gae8a3f58e1f4c6bbdc316b3ee761532b8">MSK_RST_ACK</a>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        tcp_hdr_out.seq_num = byteorder_htonl(0);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span> (ctl &amp; <a class="code" href="group__net__gnrc__tcp.html#ga3708b74de40b7d3d4dd7049ef7ff86f0">MSK_SYN</a>) {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            seq_no += 1;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">if</span> (ctl &amp; <a class="code" href="group__net__gnrc__tcp.html#ga101fc1d443c113fe0a4eeb6c3fbf06c8">MSK_FIN</a>) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            seq_no += 1;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        uint32_t tmp = byteorder_ntohl(tcp_hdr_in-&gt;seq_num);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        tcp_hdr_out.ack_num = byteorder_htonl(seq_no + tmp  + <a class="code" href="group__net__gnrc__tcp.html#ga98ecc3341028c5689ba9cdb784d8da2a">_pkt_get_pay_len</a>(in_pkt));</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">/* Allocate new tcp header */</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    tcp_snp = <a class="code" href="group__net__gnrc__pktbuf.html#ga0407cae9a01d0e57b2b5a8e3a17bac23">gnrc_pktbuf_add</a>(<a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tcp_hdr_out, <a class="code" href="group__net__gnrc__tcp.html#ga2629e70587f04d0329a72d40f7f15bdb">OPTION_OFFSET_BASE</a> * 4, GNRC_NETTYPE_TCP);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span> (tcp_snp == <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;gnrc_tcp_pkt.c : _pkt_build_reset_from_pkt() : Can&#39;t alloc buffer for TCP Header\n.&quot;</span>);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        *(out_pkt) = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="group__cpu__atmega__common.html#ga6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    *out_pkt = tcp_snp;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">/* Build new network layer header */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#ifdef MODULE_GNRC_IPV6</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    ip6_snp = <a class="code" href="group__net__gnrc__ipv6__hdr.html#gaf1cd3803edcb97066ec8b8ec19f4a2cb">gnrc_ipv6_hdr_build</a>(tcp_snp, &amp;(ip6_hdr-&gt;dst), &amp;(ip6_hdr-&gt;src));</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (ip6_snp == <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;gnrc_tcp_pkt.c : _pkt_build_reset_from_pkt() : Can&#39;t alloc buffer for IPv6 Header.\n&quot;</span>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        gnrc_pktbuf_release(tcp_snp);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        *(out_pkt) = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="group__cpu__atmega__common.html#ga6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    *out_pkt = ip6_snp;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;gnrc_tcp_pkt.c : _pkt_build_reset_from_pkt() : Network Layer Module Missing\n&quot;</span>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="group__net__gnrc__tcp.html#gafb4a043089340d1fedd1195b3766853a">  117</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__net__gnrc__tcp.html#gafb4a043089340d1fedd1195b3766853a">_pkt_build</a>(<a class="code" href="struct__transmission__control__block.html">gnrc_tcp_tcb_t</a>* tcb, <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> **out_pkt, uint16_t *seq_con,</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;               <span class="keyword">const</span> uint16_t ctl, <span class="keyword">const</span> uint32_t seq_num, <span class="keyword">const</span> uint32_t ack_num,</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;               <span class="keywordtype">void</span> *payload, <span class="keyword">const</span> <span class="keywordtype">size_t</span> payload_len)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *pay_snp = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *tcp_snp = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="group__net__gnrc__tcp.html#ga6feb29b23e0b703c41bb3f4546b6e03a">tcp_hdr_t</a> tcp_hdr;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    uint8_t nopts = 0;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">/* Add payload, if supplied */</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span> (payload != <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; payload_len &gt; 0) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        pay_snp = <a class="code" href="group__net__gnrc__pktbuf.html#ga0407cae9a01d0e57b2b5a8e3a17bac23">gnrc_pktbuf_add</a>(pay_snp, payload, payload_len, <a class="code" href="group__net__gnrc__nettype.html#gga2582fbb16a318806983c225a69460902aadb666d279898cdecd1dcc0cc18799f1">GNRC_NETTYPE_UNDEF</a>);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">if</span> (pay_snp == <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <a class="code" href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;gnrc_tcp_pkt.c : _pkt_build() : Can&#39;t allocate buffer for payload\n.&quot;</span>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            *(out_pkt) = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="group__cpu__atmega__common.html#ga6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">/* fill tcp-header */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    tcp_hdr.src_port = byteorder_htons(tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a7c8171cd15cb1f99e0a352fef95750e3">local_port</a>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    tcp_hdr.dst_port = byteorder_htons(tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a50304246315e49fdf3327dd716961b31">peer_port</a>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    tcp_hdr.checksum = byteorder_htons(0);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    tcp_hdr.seq_num = byteorder_htonl(seq_num);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    tcp_hdr.ack_num = byteorder_htonl(ack_num);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    tcp_hdr.window = byteorder_htons(tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a69fda2f763c1ba1cf217a8821b470a86">rcv_wnd</a>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    tcp_hdr.urgent_ptr = byteorder_htons(0);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">/* tcp option handling */</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">/* If this is a syn-message, send mss option */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span> (ctl &amp; <a class="code" href="group__net__gnrc__tcp.html#ga3708b74de40b7d3d4dd7049ef7ff86f0">MSK_SYN</a>) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">/* NOTE: MSS usually based on lower layers MTU */</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        tcp_hdr.options[nopts] = byteorder_htonl(<a class="code" href="group__net__gnrc__tcp.html#gad0f8901d88995cc8c05d832c399f75fe">_option_build_mss</a>(<a class="code" href="group__net__gnrc__tcp.html#gaa7e536cb887b9abd216607f286dffd9c">GNRC_TCP_MSS</a>));</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        nopts += 1;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">/* Set offset and control bit accordingly */</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    tcp_hdr.off_ctl = byteorder_htons(<a class="code" href="group__net__gnrc__tcp.html#gac9538cee0e2d5c6f315973b6a0a9afc9">_option_build_offset_control</a>(<a class="code" href="group__net__gnrc__tcp.html#ga2629e70587f04d0329a72d40f7f15bdb">OPTION_OFFSET_BASE</a> + nopts, ctl));</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">/* allocate tcp header */</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    tcp_snp = <a class="code" href="group__net__gnrc__pktbuf.html#ga0407cae9a01d0e57b2b5a8e3a17bac23">gnrc_pktbuf_add</a>(pay_snp, &amp;tcp_hdr, (<a class="code" href="group__net__gnrc__tcp.html#ga2629e70587f04d0329a72d40f7f15bdb">OPTION_OFFSET_BASE</a> + nopts) * 4, GNRC_NETTYPE_TCP);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">if</span> (tcp_snp == <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;gnrc_tcp_pkt.c : _pkt_build() : Can&#39;t allocate buffer for TCP Header\n.&quot;</span>);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        gnrc_pktbuf_release(pay_snp);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        *(out_pkt) = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="group__cpu__atmega__common.html#ga6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        *(out_pkt) = tcp_snp;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    }</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">/* Build network layer header */</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">#ifdef MODULE_GNRC_IPV6</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a>* ip6_snp = <a class="code" href="group__net__gnrc__ipv6__hdr.html#gaf1cd3803edcb97066ec8b8ec19f4a2cb">gnrc_ipv6_hdr_build</a>(tcp_snp, <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, (<a class="code" href="unionipv6__addr__t.html">ipv6_addr_t</a> *) tcb-&gt;peer_addr);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (ip6_snp == <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <a class="code" href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;gnrc_tcp_pkt.c : _pkt_build() : Can&#39;t allocate buffer for IPv6 Header.\n&quot;</span>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        gnrc_pktbuf_release(tcp_snp);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        *(out_pkt) = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="group__cpu__atmega__common.html#ga6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        *(out_pkt) = ip6_snp;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">    #else</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <a class="code" href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;gnrc_tcp_pkt.c : _pkt_build_reset_from_pkt() : Network Layer Module Missing\n&quot;</span>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">/* Calculate Sequence Space Number Consumption for this packet */</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span> (seq_con != <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        *seq_con = 0;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> (ctl &amp; MSK_SYN) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            *seq_con += 1;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">if</span> (ctl &amp; <a class="code" href="group__net__gnrc__tcp.html#ga101fc1d443c113fe0a4eeb6c3fbf06c8">MSK_FIN</a>) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            *seq_con += 1;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        *seq_con += payload_len;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="group__net__gnrc__tcp.html#gafa8796c3b96952aed6b87a15f60fc87c">  197</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__net__gnrc__tcp.html#gafa8796c3b96952aed6b87a15f60fc87c">_pkt_send</a>(<a class="code" href="struct__transmission__control__block.html">gnrc_tcp_tcb_t</a>* tcb, <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *out_pkt, <span class="keyword">const</span> uint16_t seq_con,</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">bool</span> retransmit)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (out_pkt == <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;gnrc_tcp_pkt.c : _pkt_send() : Packet to send is null\n&quot;</span>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="group__cpu__atmega__common.html#ga2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">/* If this is no retransmission, advance sequence number and measure time */</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span> (!retransmit) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a458ee314eb40ab7e0c913a036333cc0d">retries</a> = 0;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a6c931a8e85c531b4fc2636ce80eb8f9d">snd_nxt</a> += seq_con;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        tcb-&gt;<a class="code" href="struct__transmission__control__block.html#abfe2b192231624ccb96a8b7d1bb3b9f9">rtt_start</a> = xtimer_now().ticks32;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a458ee314eb40ab7e0c913a036333cc0d">retries</a> += 1;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">/* Pass packet down the network stack */</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="group__net__gnrc__netapi.html#ga379dec2cbff3ba3bdc67e5c4057ea580">gnrc_netapi_send</a>(<a class="code" href="group__net__gnrc__tcp.html#ga7e51aa6001b31e1ba2aa41f331117190">_gnrc_tcp_pid</a>, out_pkt);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="group__net__gnrc__tcp.html#gacda169a781b9aeeafd017fe038e3a22e">  220</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__net__gnrc__tcp.html#gacda169a781b9aeeafd017fe038e3a22e">_pkt_chk_seq_num</a>(<span class="keyword">const</span> <a class="code" href="struct__transmission__control__block.html">gnrc_tcp_tcb_t</a>* tcb, <span class="keyword">const</span> uint32_t seq_num, <span class="keyword">const</span> uint32_t seg_len)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;{</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    uint32_t l_edge = tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ab78b2bbc811615f283252a066572729e">rcv_nxt</a>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    uint32_t r_edge = tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ab78b2bbc811615f283252a066572729e">rcv_nxt</a> + tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a69fda2f763c1ba1cf217a8821b470a86">rcv_wnd</a>;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    uint32_t last_seq = seq_num + seg_len - 1;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">/* Possible case 1 */</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">/* Segment contains no payload and Receive window is closed and */</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">/* Sequence Number is next expected number */</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (seg_len == 0 &amp;&amp; tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a69fda2f763c1ba1cf217a8821b470a86">rcv_wnd</a> == 0 &amp;&amp; l_edge == seq_num ) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">/* Possible case 2 */</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">/* Segment contains no payload and Receive window is open and */</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">/* Sequence number falls inside the receive window */</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (seg_len == 0 &amp;&amp; tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a69fda2f763c1ba1cf217a8821b470a86">rcv_wnd</a> &gt; 0 &amp;&amp; <a class="code" href="gnrc__tcp__pkt_8c.html#a7aee945a11ee7207709773ae03ba0e1c">INSIDE_WND</a>(l_edge, seq_num, r_edge)) {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">/* Possible case 3 */</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">/* Segment contains Payload and Receive window is open and */</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">/* Sequence Number overlaps with receive window */</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (seg_len &gt; 0 &amp;&amp; tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a69fda2f763c1ba1cf217a8821b470a86">rcv_wnd</a> &gt; 0</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    &amp;&amp; (<a class="code" href="gnrc__tcp__pkt_8c.html#a7aee945a11ee7207709773ae03ba0e1c">INSIDE_WND</a>(l_edge, seq_num, r_edge) || <a class="code" href="gnrc__tcp__pkt_8c.html#a7aee945a11ee7207709773ae03ba0e1c">INSIDE_WND</a>(l_edge, last_seq, r_edge))</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    ) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">/* Everthing else is not acceptable */</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="group__net__gnrc__tcp.html#ga5ae8a1a6c93a28da60b02c1903bec292">  253</a></span>&#160;uint32_t <a class="code" href="group__net__gnrc__tcp.html#ga5ae8a1a6c93a28da60b02c1903bec292">_pkt_get_seg_len</a>(<a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *pkt)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;{</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    uint32_t seq = 0;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    uint16_t ctl = 0;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *snp = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="group__sys__ut.html#ga8c5c97079c5b259e4c0ff7c563b0f8ed">LL_SEARCH_SCALAR</a>(pkt, snp, <a class="code" href="multiboot_8h.html#a8da1a8c7127a0371eec0810a29e30f3c">type</a>, GNRC_NETTYPE_TCP);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="group__net__gnrc__tcp.html#ga6feb29b23e0b703c41bb3f4546b6e03a">tcp_hdr_t</a> *hdr = (<a class="code" href="group__net__gnrc__tcp.html#ga6feb29b23e0b703c41bb3f4546b6e03a">tcp_hdr_t</a> *) snp-&gt;<a class="code" href="structgnrc__pktsnip.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    ctl = byteorder_ntohs(hdr-&gt;off_ctl);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    seq = <a class="code" href="group__net__gnrc__tcp.html#ga98ecc3341028c5689ba9cdb784d8da2a">_pkt_get_pay_len</a>(pkt);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (ctl &amp; <a class="code" href="group__net__gnrc__tcp.html#ga3708b74de40b7d3d4dd7049ef7ff86f0">MSK_SYN</a>) {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        seq += 1;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span> (ctl &amp; <a class="code" href="group__net__gnrc__tcp.html#ga101fc1d443c113fe0a4eeb6c3fbf06c8">MSK_FIN</a>) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        seq += 1;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">return</span> seq;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;}</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="group__net__gnrc__tcp.html#ga98ecc3341028c5689ba9cdb784d8da2a">  272</a></span>&#160;uint32_t <a class="code" href="group__net__gnrc__tcp.html#ga98ecc3341028c5689ba9cdb784d8da2a">_pkt_get_pay_len</a>(<a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *pkt)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;{</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    uint32_t seg_len = 0;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *snp = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="group__sys__ut.html#ga8c5c97079c5b259e4c0ff7c563b0f8ed">LL_SEARCH_SCALAR</a>(pkt, snp, <a class="code" href="multiboot_8h.html#a8da1a8c7127a0371eec0810a29e30f3c">type</a>, <a class="code" href="group__net__gnrc__nettype.html#gga2582fbb16a318806983c225a69460902aadb666d279898cdecd1dcc0cc18799f1">GNRC_NETTYPE_UNDEF</a>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">while</span> (snp &amp;&amp; snp-&gt;<a class="code" href="structgnrc__pktsnip.html#a1145eb459cc58848b353c7379fc86c2e">type</a> == <a class="code" href="group__net__gnrc__nettype.html#gga2582fbb16a318806983c225a69460902aadb666d279898cdecd1dcc0cc18799f1">GNRC_NETTYPE_UNDEF</a>) {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        seg_len += snp-&gt;<a class="code" href="structgnrc__pktsnip.html#a854352f53b148adc24983a58a1866d66">size</a>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        snp = snp-&gt;<a class="code" href="structgnrc__pktsnip.html#a27f60a8d8a6ba92b4fb5efb325d9d937">next</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span> seg_len;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="group__net__gnrc__tcp.html#gae6ea1953042d982369bfb047e78354ae">  285</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__net__gnrc__tcp.html#gae6ea1953042d982369bfb047e78354ae">_pkt_setup_retransmit</a>(<a class="code" href="struct__transmission__control__block.html">gnrc_tcp_tcb_t</a>* tcb, <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *pkt, <span class="keyword">const</span> <span class="keywordtype">bool</span> retransmit)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;{</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *snp = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    uint32_t ctl = 0;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    uint32_t <a class="code" href="multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a> = 0;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">/* No packet received */</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (pkt == <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;gnrc_tcp_pkt.c : _pkt_setup_retransmit() : pkt=NULL\n&quot;</span>);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="group__cpu__atmega__common.html#ga2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">/* Check if retransmit queue is full and pkt is not already in retransmit queue */</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> (tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a06d90b2632bce08e55d01e1ffbc8418f">pkt_retransmit</a> != <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a06d90b2632bce08e55d01e1ffbc8418f">pkt_retransmit</a> != pkt) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;gnrc_tcp_pkt.c : _pkt_setup_retransmit() : Nothing to do\n&quot;</span>);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="group__cpu__atmega__common.html#ga6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">/* Extract control bits and segment length */</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="group__sys__ut.html#ga8c5c97079c5b259e4c0ff7c563b0f8ed">LL_SEARCH_SCALAR</a>(pkt, snp, <a class="code" href="multiboot_8h.html#a8da1a8c7127a0371eec0810a29e30f3c">type</a>, GNRC_NETTYPE_TCP);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    ctl = byteorder_ntohs(((<a class="code" href="group__net__gnrc__tcp.html#ga6feb29b23e0b703c41bb3f4546b6e03a">tcp_hdr_t</a> *) snp-&gt;<a class="code" href="structgnrc__pktsnip.html#a735984d41155bc1032e09bece8f8d66d">data</a>)-&gt;off_ctl);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    len = <a class="code" href="group__net__gnrc__tcp.html#ga98ecc3341028c5689ba9cdb784d8da2a">_pkt_get_pay_len</a>(pkt);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">/* Check if pkt contains reset or is a pure ACK, return */</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span> ((ctl &amp; <a class="code" href="group__net__gnrc__tcp.html#ga5f7f251fc046204e1af584ce646b29f7">MSK_RST</a>) || (((ctl &amp; <a class="code" href="group__net__gnrc__tcp.html#ga50225e9352404b14b910a39a3f2f9150">MSK_SYN_FIN_ACK</a>) == <a class="code" href="group__net__gnrc__tcp.html#gae0be310c4b4a33195a478e7318390782">MSK_ACK</a>) &amp;&amp; len == 0)) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">/* Assign pkt and increase users: every send attempt consumes a user */</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a06d90b2632bce08e55d01e1ffbc8418f">pkt_retransmit</a> = pkt;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="group__net__gnrc__pktbuf.html#gac679dd478531a503852093f4c044c65c">gnrc_pktbuf_hold</a>(pkt, 1);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">/* RTO Adjustment */</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span> (!retransmit) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">/* If this is the first transmission: rto is 1 sec (Lower Bound) */</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">if</span> (tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a2d405b6655205e0a70a992062e40f42b">srtt</a> == <a class="code" href="group__net__gnrc__tcp.html#ga090498a0e518a1e01f54903b7ff88e20">GNRC_TCP_RTO_UNINITIALIZED</a> || tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a38c003edefea78c1a79cee4fb7e3ab46">rtt_var</a> == <a class="code" href="group__net__gnrc__tcp.html#ga090498a0e518a1e01f54903b7ff88e20">GNRC_TCP_RTO_UNINITIALIZED</a>) {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ab0dfae57b1299ffa70be91f07f2cbb97">rto</a> = <a class="code" href="group__net__gnrc__tcp.html#ga8f6090d2714b7de5af52a77b3b2d01eb">GNRC_TCP_RTO_LOWER_BOUND</a>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ab0dfae57b1299ffa70be91f07f2cbb97">rto</a> = tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a2d405b6655205e0a70a992062e40f42b">srtt</a> + _max(<a class="code" href="group__net__gnrc__tcp.html#ga91e8504870ecfa53cea5d13e47d942ad">GNRC_TCP_RTO_GRANULARITY</a>,  <a class="code" href="group__net__gnrc__tcp.html#ga77f79b83cad3cf4a416da0c487cc00f6">GNRC_TCP_RTO_K</a> * tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a38c003edefea78c1a79cee4fb7e3ab46">rtt_var</a>);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">/* If this is a retransmission: Double the rto (Timer Backoff) */</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ab0dfae57b1299ffa70be91f07f2cbb97">rto</a> *= 2;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="comment">/* If the transmission has been tried five times, we assume srtt and rtt_var are bogus */</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">/* New measurements must be taken */</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">if</span> (tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a458ee314eb40ab7e0c913a036333cc0d">retries</a> &gt;= 5) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a2d405b6655205e0a70a992062e40f42b">srtt</a> = <a class="code" href="group__net__gnrc__tcp.html#ga090498a0e518a1e01f54903b7ff88e20">GNRC_TCP_RTO_UNINITIALIZED</a>;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a38c003edefea78c1a79cee4fb7e3ab46">rtt_var</a> = <a class="code" href="group__net__gnrc__tcp.html#ga090498a0e518a1e01f54903b7ff88e20">GNRC_TCP_RTO_UNINITIALIZED</a>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">/* Perform Boundrychecks on current RTO before usage */</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> (tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ab0dfae57b1299ffa70be91f07f2cbb97">rto</a> &lt; (int32_t) <a class="code" href="group__net__gnrc__tcp.html#ga8f6090d2714b7de5af52a77b3b2d01eb">GNRC_TCP_RTO_LOWER_BOUND</a>) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ab0dfae57b1299ffa70be91f07f2cbb97">rto</a> = <a class="code" href="group__net__gnrc__tcp.html#ga8f6090d2714b7de5af52a77b3b2d01eb">GNRC_TCP_RTO_LOWER_BOUND</a>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ab0dfae57b1299ffa70be91f07f2cbb97">rto</a> &gt; (int32_t) <a class="code" href="group__net__gnrc__tcp.html#ga23a2c25d713fa6056ddcaccfa9ee065c">GNRC_TCP_RTO_UPPER_BOUND</a>) {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ab0dfae57b1299ffa70be91f07f2cbb97">rto</a> = <a class="code" href="group__net__gnrc__tcp.html#ga23a2c25d713fa6056ddcaccfa9ee065c">GNRC_TCP_RTO_UPPER_BOUND</a>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">/* Setup retransmission timer, msg to TCP thread with ptr to tcb */</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ac952a884e8a9b7574972e187d4c3a885">msg_tout</a>.<a class="code" href="structmsg__t.html#acb5cfd209ba75c853d03f701e7f91679">type</a> = <a class="code" href="group__net__gnrc__tcp.html#ga177b15102f89fa912de0e0bd656cd90c">MSG_TYPE_RETRANSMISSION</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ac952a884e8a9b7574972e187d4c3a885">msg_tout</a>.<a class="code" href="structmsg__t.html#ae0dd071afd4c761faee99d3ecd2bbb0d">content</a>.<a class="code" href="structmsg__t.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = (<span class="keywordtype">void</span> *)tcb;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    xtimer_set_msg(&amp;tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a40173d8faca4a059c9651c46d81e2d24">tim_tout</a>, tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ab0dfae57b1299ffa70be91f07f2cbb97">rto</a>, &amp;tcb-&gt;<a class="code" href="struct__transmission__control__block.html#ac952a884e8a9b7574972e187d4c3a885">msg_tout</a>, <a class="code" href="group__net__gnrc__tcp.html#ga7e51aa6001b31e1ba2aa41f331117190">_gnrc_tcp_pid</a>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="group__net__gnrc__tcp.html#gafed1901a0aa1c0366f9e724ad6fd2430">  354</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__net__gnrc__tcp.html#gafed1901a0aa1c0366f9e724ad6fd2430">_pkt_acknowledge</a>(<a class="code" href="struct__transmission__control__block.html">gnrc_tcp_tcb_t</a>* tcb, <span class="keyword">const</span> uint32_t ack)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;{</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    uint32_t seg = 0;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *snp = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="group__net__gnrc__tcp.html#ga6feb29b23e0b703c41bb3f4546b6e03a">tcp_hdr_t</a> *hdr;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">/* Retransmission Queue is empty. Nothing to ACK there */</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a06d90b2632bce08e55d01e1ffbc8418f">pkt_retransmit</a> == <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a>(<span class="stringliteral">&quot;gnrc_tcp_pkt.c : _pkt_acknowledge() : There is no packet to ack\n&quot;</span>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="group__cpu__atmega__common.html#ga0030614bc864d1b24eaedd71585acc27">ENODATA</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="group__sys__ut.html#ga8c5c97079c5b259e4c0ff7c563b0f8ed">LL_SEARCH_SCALAR</a>(tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a06d90b2632bce08e55d01e1ffbc8418f">pkt_retransmit</a>, snp, <a class="code" href="multiboot_8h.html#a8da1a8c7127a0371eec0810a29e30f3c">type</a>, GNRC_NETTYPE_TCP);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    hdr = (<a class="code" href="group__net__gnrc__tcp.html#ga6feb29b23e0b703c41bb3f4546b6e03a">tcp_hdr_t</a> *) snp-&gt;<a class="code" href="structgnrc__pktsnip.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">/* There must be a packet, waiting to be acknowledged. */</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    seg = byteorder_ntohl(hdr-&gt;seq_num) + <a class="code" href="group__net__gnrc__tcp.html#ga5ae8a1a6c93a28da60b02c1903bec292">_pkt_get_seg_len</a>(tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a06d90b2632bce08e55d01e1ffbc8418f">pkt_retransmit</a>) - 1;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">/* If segment can be acknowledged -&gt; stop timer, release packet from pktbuf and update rto. */</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__net__gnrc__tcp.html#ga2a85996b4590cf93ffc94cf1ecb1c0b4">LSS_32_BIT</a>(seg, ack)) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <a class="code" href="group__sys__xtimer.html#ga2b6666a277679ca79aaa27db957057ab">xtimer_remove</a>(&amp;(tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a40173d8faca4a059c9651c46d81e2d24">tim_tout</a>));</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        gnrc_pktbuf_release(tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a06d90b2632bce08e55d01e1ffbc8418f">pkt_retransmit</a>);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a06d90b2632bce08e55d01e1ffbc8418f">pkt_retransmit</a> = <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="comment">/* Measure Round Trip Time */</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        int32_t rtt = xtimer_now().ticks32 - tcb-&gt;<a class="code" href="struct__transmission__control__block.html#abfe2b192231624ccb96a8b7d1bb3b9f9">rtt_start</a>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="comment">/* Use sample only if ther was no timeroverflow and no retransmission (Karns Alogrithm) */</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">if</span> (tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a458ee314eb40ab7e0c913a036333cc0d">retries</a> == 0 &amp;&amp; rtt &gt; 0) {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="comment">/* If this is the first sample taken */</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keywordflow">if</span> (tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a2d405b6655205e0a70a992062e40f42b">srtt</a> == <a class="code" href="group__net__gnrc__tcp.html#ga090498a0e518a1e01f54903b7ff88e20">GNRC_TCP_RTO_UNINITIALIZED</a></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            &amp;&amp; tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a38c003edefea78c1a79cee4fb7e3ab46">rtt_var</a> == <a class="code" href="group__net__gnrc__tcp.html#ga090498a0e518a1e01f54903b7ff88e20">GNRC_TCP_RTO_UNINITIALIZED</a></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            ) {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a2d405b6655205e0a70a992062e40f42b">srtt</a> = rtt;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a38c003edefea78c1a79cee4fb7e3ab46">rtt_var</a> = (rtt &gt;&gt; 1);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="comment">/* If this is a subsequent sample */</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                 tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a38c003edefea78c1a79cee4fb7e3ab46">rtt_var</a> = (tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a38c003edefea78c1a79cee4fb7e3ab46">rtt_var</a> / <a class="code" href="group__net__gnrc__tcp.html#gaa810c1994167c49e29fd63c7cf899c60">GNRC_TCP_RTO_B_DIV</a>) * (<a class="code" href="group__net__gnrc__tcp.html#gaa810c1994167c49e29fd63c7cf899c60">GNRC_TCP_RTO_B_DIV</a>-1);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                 tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a38c003edefea78c1a79cee4fb7e3ab46">rtt_var</a> += abs(tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a2d405b6655205e0a70a992062e40f42b">srtt</a> - rtt) / <a class="code" href="group__net__gnrc__tcp.html#gaa810c1994167c49e29fd63c7cf899c60">GNRC_TCP_RTO_B_DIV</a>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                 tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a2d405b6655205e0a70a992062e40f42b">srtt</a> = (tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a2d405b6655205e0a70a992062e40f42b">srtt</a> / <a class="code" href="group__net__gnrc__tcp.html#gaee9d9c41d5d5bdf6e27098522e976f9e">GNRC_TCP_RTO_A_DIV</a>) * (<a class="code" href="group__net__gnrc__tcp.html#gaee9d9c41d5d5bdf6e27098522e976f9e">GNRC_TCP_RTO_A_DIV</a>-1);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                 tcb-&gt;<a class="code" href="struct__transmission__control__block.html#a2d405b6655205e0a70a992062e40f42b">srtt</a> += rtt / <a class="code" href="group__net__gnrc__tcp.html#gaee9d9c41d5d5bdf6e27098522e976f9e">GNRC_TCP_RTO_A_DIV</a>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="group__net__gnrc__tcp.html#gabb7cd190f9fd311f56072aa04cbc92d0">  402</a></span>&#160;uint16_t <a class="code" href="group__net__gnrc__tcp.html#gabb7cd190f9fd311f56072aa04cbc92d0">_pkt_calc_csum</a>(<span class="keyword">const</span> <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *hdr,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        <span class="keyword">const</span> <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *pseudo_hdr,</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        <span class="keyword">const</span> <a class="code" href="structgnrc__pktsnip.html">gnrc_pktsnip_t</a> *payload)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;{</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    uint16_t csum = 0;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    uint16_t <a class="code" href="multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a> = (uint16_t) hdr-&gt;<a class="code" href="structgnrc__pktsnip.html#a854352f53b148adc24983a58a1866d66">size</a>;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span>(pseudo_hdr == <a class="code" href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">/* Process payload */</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">while</span> (payload &amp;&amp; payload != hdr) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        csum = inet_csum(csum, (uint8_t *)payload-&gt;<a class="code" href="structgnrc__pktsnip.html#a735984d41155bc1032e09bece8f8d66d">data</a>, payload-&gt;<a class="code" href="structgnrc__pktsnip.html#a854352f53b148adc24983a58a1866d66">size</a>);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        len += (uint16_t)payload-&gt;<a class="code" href="structgnrc__pktsnip.html#a854352f53b148adc24983a58a1866d66">size</a>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        payload = payload-&gt;<a class="code" href="structgnrc__pktsnip.html#a27f60a8d8a6ba92b4fb5efb325d9d937">next</a>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">/* Process tcp-header, before checksum field(Byte 16 to 18) */</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    csum = inet_csum(csum, (uint8_t *)hdr-&gt;<a class="code" href="structgnrc__pktsnip.html#a735984d41155bc1032e09bece8f8d66d">data</a>, 16);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">/* Process tcp-header, after checksum field */</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    csum = inet_csum(csum, ((uint8_t *)hdr-&gt;<a class="code" href="structgnrc__pktsnip.html#a735984d41155bc1032e09bece8f8d66d">data</a>) + 18, hdr-&gt;<a class="code" href="structgnrc__pktsnip.html#a854352f53b148adc24983a58a1866d66">size</a> - 18);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">/* Process Network layer Header */</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">switch</span> (pseudo_hdr-&gt;<a class="code" href="structgnrc__pktsnip.html#a1145eb459cc58848b353c7379fc86c2e">type</a>) {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">#ifdef MODULE_GNRC_IPV6</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">case</span> GNRC_NETTYPE_IPV6:</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            csum = ipv6_hdr_inet_csum(csum, pseudo_hdr-&gt;<a class="code" href="structgnrc__pktsnip.html#a735984d41155bc1032e09bece8f8d66d">data</a>, <a class="code" href="group__net__protnum.html#gae25eadf44223e2a1ac30b3b6b21b9dd9">PROTNUM_TCP</a>, len);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">return</span> ~csum;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">/* Cleanup, defines */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">#undef INSIDE_WND</span></div><div class="ttc" id="group__net__gnrc__tcp_html_gaa810c1994167c49e29fd63c7cf899c60"><div class="ttname"><a href="group__net__gnrc__tcp.html#gaa810c1994167c49e29fd63c7cf899c60">GNRC_TCP_RTO_B_DIV</a></div><div class="ttdeci">#define GNRC_TCP_RTO_B_DIV</div><div class="ttdoc">Beta value for RTO calculation, default is 1/4. </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00146">config.h:146</a></div></div>
<div class="ttc" id="group__cpu__atmega__common_html_ga0030614bc864d1b24eaedd71585acc27"><div class="ttname"><a href="group__cpu__atmega__common.html#ga0030614bc864d1b24eaedd71585acc27">ENODATA</a></div><div class="ttdeci">#define ENODATA</div><div class="ttdef"><b>Definition:</b> <a href="errno_8h_source.html#l00110">errno.h:110</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga177b15102f89fa912de0e0bd656cd90c"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga177b15102f89fa912de0e0bd656cd90c">MSG_TYPE_RETRANSMISSION</a></div><div class="ttdeci">#define MSG_TYPE_RETRANSMISSION</div><div class="ttdef"><b>Definition:</b> <a href="net_2gnrc_2transport__layer_2tcp_2internal_2helper_8h_source.html#l00058">helper.h:58</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gae6ea1953042d982369bfb047e78354ae"><div class="ttname"><a href="group__net__gnrc__tcp.html#gae6ea1953042d982369bfb047e78354ae">_pkt_setup_retransmit</a></div><div class="ttdeci">int _pkt_setup_retransmit(gnrc_tcp_tcb_t *tcb, gnrc_pktsnip_t *pkt, const bool retransmit)</div><div class="ttdoc">Adds a paket to the retransmission mechanism. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__pkt_8c_source.html#l00285">gnrc_tcp_pkt.c:285</a></div></div>
<div class="ttc" id="net_2gnrc_2transport__layer_2tcp_2internal_2helper_8h_html"><div class="ttname"><a href="net_2gnrc_2transport__layer_2tcp_2internal_2helper_8h.html">helper.h</a></div><div class="ttdoc">Helperfunctions and defines. </div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga5f7f251fc046204e1af584ce646b29f7"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga5f7f251fc046204e1af584ce646b29f7">MSK_RST</a></div><div class="ttdeci">#define MSK_RST</div><div class="ttdef"><b>Definition:</b> <a href="net_2gnrc_2transport__layer_2tcp_2internal_2helper_8h_source.html#l00038">helper.h:38</a></div></div>
<div class="ttc" id="eventloop_8h_html"><div class="ttname"><a href="eventloop_8h.html">eventloop.h</a></div><div class="ttdoc">Definition for gnrc tcp event processing loop. </div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gafed1901a0aa1c0366f9e724ad6fd2430"><div class="ttname"><a href="group__net__gnrc__tcp.html#gafed1901a0aa1c0366f9e724ad6fd2430">_pkt_acknowledge</a></div><div class="ttdeci">int _pkt_acknowledge(gnrc_tcp_tcb_t *tcb, const uint32_t ack)</div><div class="ttdoc">Acknowledges and removes packet from the retransmission mechanism. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__pkt_8c_source.html#l00354">gnrc_tcp_pkt.c:354</a></div></div>
<div class="ttc" id="errno_8h_html"><div class="ttname"><a href="errno_8h.html">errno.h</a></div></div>
<div class="ttc" id="debug_8h_html"><div class="ttname"><a href="debug_8h.html">debug.h</a></div><div class="ttdoc">Debug-header. </div></div>
<div class="ttc" id="net_2gnrc_2transport__layer_2tcp_2internal_2pkt_8h_html"><div class="ttname"><a href="net_2gnrc_2transport__layer_2tcp_2internal_2pkt_8h.html">pkt.h</a></div><div class="ttdoc">Functions for TCP&amp;#39;s paket handling. </div></div>
<div class="ttc" id="struct__transmission__control__block_html_a2d405b6655205e0a70a992062e40f42b"><div class="ttname"><a href="struct__transmission__control__block.html#a2d405b6655205e0a70a992062e40f42b">_transmission_control_block::srtt</a></div><div class="ttdeci">int32_t srtt</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00067">tcb.h:67</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga98ecc3341028c5689ba9cdb784d8da2a"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga98ecc3341028c5689ba9cdb784d8da2a">_pkt_get_pay_len</a></div><div class="ttdeci">uint32_t _pkt_get_pay_len(gnrc_pktsnip_t *pkt)</div><div class="ttdoc">Calculates a segments payload length. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__pkt_8c_source.html#l00272">gnrc_tcp_pkt.c:272</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gae0be310c4b4a33195a478e7318390782"><div class="ttname"><a href="group__net__gnrc__tcp.html#gae0be310c4b4a33195a478e7318390782">MSK_ACK</a></div><div class="ttdeci">#define MSK_ACK</div><div class="ttdef"><b>Definition:</b> <a href="net_2gnrc_2transport__layer_2tcp_2internal_2helper_8h_source.html#l00040">helper.h:40</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gacda169a781b9aeeafd017fe038e3a22e"><div class="ttname"><a href="group__net__gnrc__tcp.html#gacda169a781b9aeeafd017fe038e3a22e">_pkt_chk_seq_num</a></div><div class="ttdeci">int _pkt_chk_seq_num(const gnrc_tcp_tcb_t *tcb, const uint32_t seq_num, const uint32_t seg_len)</div><div class="ttdoc">Checks sequence number. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__pkt_8c_source.html#l00220">gnrc_tcp_pkt.c:220</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gad0f8901d88995cc8c05d832c399f75fe"><div class="ttname"><a href="group__net__gnrc__tcp.html#gad0f8901d88995cc8c05d832c399f75fe">_option_build_mss</a></div><div class="ttdeci">uint32_t _option_build_mss(uint16_t mss)</div><div class="ttdoc">Helper Function to build the MSS Option. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__option_8c_source.html#l00025">gnrc_tcp_option.c:25</a></div></div>
<div class="ttc" id="multiboot_8h_html_a8da1a8c7127a0371eec0810a29e30f3c"><div class="ttname"><a href="multiboot_8h.html#a8da1a8c7127a0371eec0810a29e30f3c">type</a></div><div class="ttdeci">multiboot_uint32_t type</div><div class="ttdef"><b>Definition:</b> <a href="multiboot_8h_source.html#l00120">multiboot.h:120</a></div></div>
<div class="ttc" id="group__net__protnum_html_gae25eadf44223e2a1ac30b3b6b21b9dd9"><div class="ttname"><a href="group__net__protnum.html#gae25eadf44223e2a1ac30b3b6b21b9dd9">PROTNUM_TCP</a></div><div class="ttdeci">#define PROTNUM_TCP</div><div class="ttdef"><b>Definition:</b> <a href="protnum_8h_source.html#l00040">protnum.h:40</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga50225e9352404b14b910a39a3f2f9150"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga50225e9352404b14b910a39a3f2f9150">MSK_SYN_FIN_ACK</a></div><div class="ttdeci">#define MSK_SYN_FIN_ACK</div><div class="ttdef"><b>Definition:</b> <a href="net_2gnrc_2transport__layer_2tcp_2internal_2helper_8h_source.html#l00045">helper.h:45</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga7e51aa6001b31e1ba2aa41f331117190"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga7e51aa6001b31e1ba2aa41f331117190">_gnrc_tcp_pid</a></div><div class="ttdeci">kernel_pid_t _gnrc_tcp_pid</div><div class="ttdoc">TCPs eventloop pid, declared externally. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp_8c_source.html#l00064">gnrc_tcp.c:64</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html_a06d90b2632bce08e55d01e1ffbc8418f"><div class="ttname"><a href="struct__transmission__control__block.html#a06d90b2632bce08e55d01e1ffbc8418f">_transmission_control_block::pkt_retransmit</a></div><div class="ttdeci">gnrc_pktsnip_t * pkt_retransmit</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00072">tcb.h:72</a></div></div>
<div class="ttc" id="option_8h_html"><div class="ttname"><a href="option_8h.html">option.h</a></div><div class="ttdoc">Defines and Macros for TCP option handling. </div></div>
<div class="ttc" id="gnrc__tcp__pkt_8c_html_a7aee945a11ee7207709773ae03ba0e1c"><div class="ttname"><a href="gnrc__tcp__pkt_8c.html#a7aee945a11ee7207709773ae03ba0e1c">INSIDE_WND</a></div><div class="ttdeci">#define INSIDE_WND(l_ed, seq_num, r_ed)</div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__pkt_8c_source.html#l00035">gnrc_tcp_pkt.c:35</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga6feb29b23e0b703c41bb3f4546b6e03a"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga6feb29b23e0b703c41bb3f4546b6e03a">tcp_hdr_t</a></div><div class="ttdeci">tcp_hdr_t</div><div class="ttdef"><b>Definition:</b> <a href="gnrc_2tcp_2hdr_8h_source.html#l00049">hdr.h:49</a></div></div>
<div class="ttc" id="pktbuf_8h_html"><div class="ttname"><a href="pktbuf_8h.html">pktbuf.h</a></div><div class="ttdoc">Interface definition for the global network buffer. Network devices and layers can allocate space for...</div></div>
<div class="ttc" id="group__net__gnrc__pktbuf_html_ga0407cae9a01d0e57b2b5a8e3a17bac23"><div class="ttname"><a href="group__net__gnrc__pktbuf.html#ga0407cae9a01d0e57b2b5a8e3a17bac23">gnrc_pktbuf_add</a></div><div class="ttdeci">gnrc_pktsnip_t * gnrc_pktbuf_add(gnrc_pktsnip_t *next, void *data, size_t size, gnrc_nettype_t type)</div><div class="ttdoc">Adds a new gnrc_pktsnip_t and its packet to the packet buffer. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__pktbuf__static_8c_source.html#l00092">gnrc_pktbuf_static.c:92</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga23a2c25d713fa6056ddcaccfa9ee065c"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga23a2c25d713fa6056ddcaccfa9ee065c">GNRC_TCP_RTO_UPPER_BOUND</a></div><div class="ttdeci">#define GNRC_TCP_RTO_UPPER_BOUND</div><div class="ttdoc">Upper Bound for RTO = 60 sec (see RFC 6298) </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00125">config.h:125</a></div></div>
<div class="ttc" id="group__net__gnrc__pktbuf_html_gac679dd478531a503852093f4c044c65c"><div class="ttname"><a href="group__net__gnrc__pktbuf.html#gac679dd478531a503852093f4c044c65c">gnrc_pktbuf_hold</a></div><div class="ttdeci">void gnrc_pktbuf_hold(gnrc_pktsnip_t *pkt, unsigned int num)</div><div class="ttdoc">Increases gnrc_pktsnip_t::users of pkt atomically. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__pktbuf__static_8c_source.html#l00216">gnrc_pktbuf_static.c:216</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga2629e70587f04d0329a72d40f7f15bdb"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga2629e70587f04d0329a72d40f7f15bdb">OPTION_OFFSET_BASE</a></div><div class="ttdeci">#define OPTION_OFFSET_BASE</div><div class="ttdoc">TCP Option field boundries. </div><div class="ttdef"><b>Definition:</b> <a href="option_8h_source.html#l00037">option.h:37</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gafa8796c3b96952aed6b87a15f60fc87c"><div class="ttname"><a href="group__net__gnrc__tcp.html#gafa8796c3b96952aed6b87a15f60fc87c">_pkt_send</a></div><div class="ttdeci">int _pkt_send(gnrc_tcp_tcb_t *tcb, gnrc_pktsnip_t *out_pkt, const uint16_t seq_con, const bool retransmit)</div><div class="ttdoc">Sends a packet to the peer. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__pkt_8c_source.html#l00197">gnrc_tcp_pkt.c:197</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga090498a0e518a1e01f54903b7ff88e20"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga090498a0e518a1e01f54903b7ff88e20">GNRC_TCP_RTO_UNINITIALIZED</a></div><div class="ttdeci">#define GNRC_TCP_RTO_UNINITIALIZED</div><div class="ttdoc">Macro to mark is the time measurement is uninitialized. </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00160">config.h:160</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga8f6090d2714b7de5af52a77b3b2d01eb"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga8f6090d2714b7de5af52a77b3b2d01eb">GNRC_TCP_RTO_LOWER_BOUND</a></div><div class="ttdeci">#define GNRC_TCP_RTO_LOWER_BOUND</div><div class="ttdoc">Lower Bound for RTO = 1 sec (see RFC 6298) </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00118">config.h:118</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gac9538cee0e2d5c6f315973b6a0a9afc9"><div class="ttname"><a href="group__net__gnrc__tcp.html#gac9538cee0e2d5c6f315973b6a0a9afc9">_option_build_offset_control</a></div><div class="ttdeci">uint16_t _option_build_offset_control(uint16_t nopts, uint16_t ctl)</div><div class="ttdoc">Helper Function to build the combined option and control flag field. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__option_8c_source.html#l00030">gnrc_tcp_option.c:30</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html"><div class="ttname"><a href="struct__transmission__control__block.html">_transmission_control_block</a></div><div class="ttdoc">transmission control block of gnrc_tcp </div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00045">tcb.h:45</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html_a458ee314eb40ab7e0c913a036333cc0d"><div class="ttname"><a href="struct__transmission__control__block.html#a458ee314eb40ab7e0c913a036333cc0d">_transmission_control_block::retries</a></div><div class="ttdeci">uint8_t retries</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00069">tcb.h:69</a></div></div>
<div class="ttc" id="structmsg__t_html_acb5cfd209ba75c853d03f701e7f91679"><div class="ttname"><a href="structmsg__t.html#acb5cfd209ba75c853d03f701e7f91679">msg_t::type</a></div><div class="ttdeci">uint16_t type</div><div class="ttdef"><b>Definition:</b> <a href="msg_8h_source.html#l00187">msg.h:187</a></div></div>
<div class="ttc" id="group__sys__ut_html_ga8c5c97079c5b259e4c0ff7c563b0f8ed"><div class="ttname"><a href="group__sys__ut.html#ga8c5c97079c5b259e4c0ff7c563b0f8ed">LL_SEARCH_SCALAR</a></div><div class="ttdeci">#define LL_SEARCH_SCALAR(head, out, field, val)</div><div class="ttdoc">LL scalar search for element with value &amp;#39;val&amp;#39; for member &amp;#39;field&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="utlist_8h_source.html#l00488">utlist.h:488</a></div></div>
<div class="ttc" id="structgnrc__pktsnip_html_a1145eb459cc58848b353c7379fc86c2e"><div class="ttname"><a href="structgnrc__pktsnip.html#a1145eb459cc58848b353c7379fc86c2e">gnrc_pktsnip::type</a></div><div class="ttdeci">gnrc_nettype_t type</div><div class="ttdef"><b>Definition:</b> <a href="include_2net_2gnrc_2pkt_8h_source.html#l00113">pkt.h:113</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga2a85996b4590cf93ffc94cf1ecb1c0b4"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga2a85996b4590cf93ffc94cf1ecb1c0b4">LSS_32_BIT</a></div><div class="ttdeci">#define LSS_32_BIT(x, y)</div><div class="ttdoc">Overflow tolerant comparision operators for sequence and acknowledgement number comparision. </div><div class="ttdef"><b>Definition:</b> <a href="net_2gnrc_2transport__layer_2tcp_2internal_2helper_8h_source.html#l00068">helper.h:68</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html_a50304246315e49fdf3327dd716961b31"><div class="ttname"><a href="struct__transmission__control__block.html#a50304246315e49fdf3327dd716961b31">_transmission_control_block::peer_port</a></div><div class="ttdeci">uint16_t peer_port</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00052">tcb.h:52</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga77f79b83cad3cf4a416da0c487cc00f6"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga77f79b83cad3cf4a416da0c487cc00f6">GNRC_TCP_RTO_K</a></div><div class="ttdeci">#define GNRC_TCP_RTO_K</div><div class="ttdoc">K value for RTO calculation, default is 4. </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00153">config.h:153</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html_a69fda2f763c1ba1cf217a8821b470a86"><div class="ttname"><a href="struct__transmission__control__block.html#a69fda2f763c1ba1cf217a8821b470a86">_transmission_control_block::rcv_wnd</a></div><div class="ttdeci">uint16_t rcv_wnd</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00061">tcb.h:61</a></div></div>
<div class="ttc" id="group__cpu__atmega__common_html_ga2d1678d5a7cc8ce499643f3b8957def4"><div class="ttname"><a href="group__cpu__atmega__common.html#ga2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a></div><div class="ttdeci">#define EINVAL</div><div class="ttdef"><b>Definition:</b> <a href="errno_8h_source.html#l00095">errno.h:95</a></div></div>
<div class="ttc" id="std_impl_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="std_impl_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="std_impl_8h_source.html#l00043">stdImpl.h:43</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html_ac952a884e8a9b7574972e187d4c3a885"><div class="ttname"><a href="struct__transmission__control__block.html#ac952a884e8a9b7574972e187d4c3a885">_transmission_control_block::msg_tout</a></div><div class="ttdeci">msg_t msg_tout</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00071">tcb.h:71</a></div></div>
<div class="ttc" id="structgnrc__pktsnip_html_a27f60a8d8a6ba92b4fb5efb325d9d937"><div class="ttname"><a href="structgnrc__pktsnip.html#a27f60a8d8a6ba92b4fb5efb325d9d937">gnrc_pktsnip::next</a></div><div class="ttdeci">struct gnrc_pktsnip * next</div><div class="ttdef"><b>Definition:</b> <a href="include_2net_2gnrc_2pkt_8h_source.html#l00110">pkt.h:110</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gabb7cd190f9fd311f56072aa04cbc92d0"><div class="ttname"><a href="group__net__gnrc__tcp.html#gabb7cd190f9fd311f56072aa04cbc92d0">_pkt_calc_csum</a></div><div class="ttdeci">uint16_t _pkt_calc_csum(const gnrc_pktsnip_t *hdr, const gnrc_pktsnip_t *pseudo_hdr, const gnrc_pktsnip_t *payload)</div><div class="ttdoc">Calculates checksum over payload, tcp-header and network layer header. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__pkt_8c_source.html#l00402">gnrc_tcp_pkt.c:402</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gae8a3f58e1f4c6bbdc316b3ee761532b8"><div class="ttname"><a href="group__net__gnrc__tcp.html#gae8a3f58e1f4c6bbdc316b3ee761532b8">MSK_RST_ACK</a></div><div class="ttdeci">#define MSK_RST_ACK</div><div class="ttdef"><b>Definition:</b> <a href="net_2gnrc_2transport__layer_2tcp_2internal_2helper_8h_source.html#l00044">helper.h:44</a></div></div>
<div class="ttc" id="utlist_8h_html"><div class="ttname"><a href="utlist_8h.html">utlist.h</a></div><div class="ttdoc">Macros for basic linked list operations. </div></div>
<div class="ttc" id="group__core__util_html_ga96dd473db0b3d10bd43390cdacb00120"><div class="ttname"><a href="group__core__util.html#ga96dd473db0b3d10bd43390cdacb00120">DEBUG</a></div><div class="ttdeci">#define DEBUG(...)</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00097">debug.h:97</a></div></div>
<div class="ttc" id="group__net__gnrc__nettype_html_gga2582fbb16a318806983c225a69460902aadb666d279898cdecd1dcc0cc18799f1"><div class="ttname"><a href="group__net__gnrc__nettype.html#gga2582fbb16a318806983c225a69460902aadb666d279898cdecd1dcc0cc18799f1">GNRC_NETTYPE_UNDEF</a></div><div class="ttdef"><b>Definition:</b> <a href="nettype_8h_source.html#l00053">nettype.h:53</a></div></div>
<div class="ttc" id="msg_8h_html"><div class="ttname"><a href="msg_8h.html">msg.h</a></div><div class="ttdoc">Messaging API for inter process communication. </div></div>
<div class="ttc" id="group__net__gnrc__ipv6__hdr_html_gaf1cd3803edcb97066ec8b8ec19f4a2cb"><div class="ttname"><a href="group__net__gnrc__ipv6__hdr.html#gaf1cd3803edcb97066ec8b8ec19f4a2cb">gnrc_ipv6_hdr_build</a></div><div class="ttdeci">gnrc_pktsnip_t * gnrc_ipv6_hdr_build(gnrc_pktsnip_t *payload, const ipv6_addr_t *src, const ipv6_addr_t *dst)</div><div class="ttdoc">Builds an IPv6 header for sending and adds it to the packet buffer. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__ipv6__hdr_8c_source.html#l00035">gnrc_ipv6_hdr.c:35</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html_a38c003edefea78c1a79cee4fb7e3ab46"><div class="ttname"><a href="struct__transmission__control__block.html#a38c003edefea78c1a79cee4fb7e3ab46">_transmission_control_block::rtt_var</a></div><div class="ttdeci">int32_t rtt_var</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00066">tcb.h:66</a></div></div>
<div class="ttc" id="structgnrc__pktsnip_html_a854352f53b148adc24983a58a1866d66"><div class="ttname"><a href="structgnrc__pktsnip.html#a854352f53b148adc24983a58a1866d66">gnrc_pktsnip::size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> <a href="include_2net_2gnrc_2pkt_8h_source.html#l00112">pkt.h:112</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html_ab78b2bbc811615f283252a066572729e"><div class="ttname"><a href="struct__transmission__control__block.html#ab78b2bbc811615f283252a066572729e">_transmission_control_block::rcv_nxt</a></div><div class="ttdeci">uint32_t rcv_nxt</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00060">tcb.h:60</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga101fc1d443c113fe0a4eeb6c3fbf06c8"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga101fc1d443c113fe0a4eeb6c3fbf06c8">MSK_FIN</a></div><div class="ttdeci">#define MSK_FIN</div><div class="ttdoc">Bitmasks for control bit handling. </div><div class="ttdef"><b>Definition:</b> <a href="net_2gnrc_2transport__layer_2tcp_2internal_2helper_8h_source.html#l00036">helper.h:36</a></div></div>
<div class="ttc" id="gnrc_2tcp_8h_html"><div class="ttname"><a href="gnrc_2tcp_8h.html">tcp.h</a></div><div class="ttdoc">TCP interface definition. </div></div>
<div class="ttc" id="group__net__ipv6__hdr_html_ga0846d585b3470fba8677f853cec37c23"><div class="ttname"><a href="group__net__ipv6__hdr.html#ga0846d585b3470fba8677f853cec37c23">ipv6_hdr_t</a></div><div class="ttdeci">ipv6_hdr_t</div><div class="ttdef"><b>Definition:</b> <a href="ipv6_2hdr_8h_source.html#l00096">hdr.h:96</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gad9390ed91a77ee5dbdc0b12a757112a2"><div class="ttname"><a href="group__net__gnrc__tcp.html#gad9390ed91a77ee5dbdc0b12a757112a2">_pkt_build_reset_from_pkt</a></div><div class="ttdeci">int _pkt_build_reset_from_pkt(gnrc_pktsnip_t **out_pkt, gnrc_pktsnip_t *in_pkt)</div><div class="ttdoc">Build a reset packet from an incomming packet. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__pkt_8c_source.html#l00050">gnrc_tcp_pkt.c:50</a></div></div>
<div class="ttc" id="multiboot_8h_html_a6de3a6d27a7e07942958b912d39792e6"><div class="ttname"><a href="multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a></div><div class="ttdeci">multiboot_uint64_t len</div><div class="ttdef"><b>Definition:</b> <a href="multiboot_8h_source.html#l00117">multiboot.h:117</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gaa7e536cb887b9abd216607f286dffd9c"><div class="ttname"><a href="group__net__gnrc__tcp.html#gaa7e536cb887b9abd216607f286dffd9c">GNRC_TCP_MSS</a></div><div class="ttdeci">#define GNRC_TCP_MSS</div><div class="ttdoc">Maximum Segement Size. </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00082">config.h:82</a></div></div>
<div class="ttc" id="group__net__gnrc__netapi_html_ga379dec2cbff3ba3bdc67e5c4057ea580"><div class="ttname"><a href="group__net__gnrc__netapi.html#ga379dec2cbff3ba3bdc67e5c4057ea580">gnrc_netapi_send</a></div><div class="ttdeci">int gnrc_netapi_send(kernel_pid_t pid, gnrc_pktsnip_t *pkt)</div><div class="ttdoc">Shortcut function for sending GNRC_NETAPI_MSG_TYPE_SND messages. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__netapi_8c_source.html#l00148">gnrc_netapi.c:148</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html_a7c8171cd15cb1f99e0a352fef95750e3"><div class="ttname"><a href="struct__transmission__control__block.html#a7c8171cd15cb1f99e0a352fef95750e3">_transmission_control_block::local_port</a></div><div class="ttdeci">uint16_t local_port</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00051">tcb.h:51</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga5ae8a1a6c93a28da60b02c1903bec292"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga5ae8a1a6c93a28da60b02c1903bec292">_pkt_get_seg_len</a></div><div class="ttdeci">uint32_t _pkt_get_seg_len(gnrc_pktsnip_t *pkt)</div><div class="ttdoc">Extracts the length of a segment. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__pkt_8c_source.html#l00253">gnrc_tcp_pkt.c:253</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html_a6c931a8e85c531b4fc2636ce80eb8f9d"><div class="ttname"><a href="struct__transmission__control__block.html#a6c931a8e85c531b4fc2636ce80eb8f9d">_transmission_control_block::snd_nxt</a></div><div class="ttdeci">uint32_t snd_nxt</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00056">tcb.h:56</a></div></div>
<div class="ttc" id="structgnrc__pktsnip_html"><div class="ttname"><a href="structgnrc__pktsnip.html">gnrc_pktsnip</a></div><div class="ttdoc">Type to represent parts (either headers or payload) of a packet, called snips. </div><div class="ttdef"><b>Definition:</b> <a href="include_2net_2gnrc_2pkt_8h_source.html#l00103">pkt.h:103</a></div></div>
<div class="ttc" id="unionipv6__addr__t_html"><div class="ttname"><a href="unionipv6__addr__t.html">ipv6_addr_t</a></div><div class="ttdoc">Data type to represent an IPv6 address. </div><div class="ttdef"><b>Definition:</b> <a href="ipv6_2addr_8h_source.html#l00074">addr.h:74</a></div></div>
<div class="ttc" id="structmsg__t_html_ae0dd071afd4c761faee99d3ecd2bbb0d"><div class="ttname"><a href="structmsg__t.html#ae0dd071afd4c761faee99d3ecd2bbb0d">msg_t::content</a></div><div class="ttdeci">union msg_t::@4 content</div></div>
<div class="ttc" id="struct__transmission__control__block_html_abfe2b192231624ccb96a8b7d1bb3b9f9"><div class="ttname"><a href="struct__transmission__control__block.html#abfe2b192231624ccb96a8b7d1bb3b9f9">_transmission_control_block::rtt_start</a></div><div class="ttdeci">uint32_t rtt_start</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00065">tcb.h:65</a></div></div>
<div class="ttc" id="group__cpu__atmega__common_html_ga6a05c923dad0c1208043e9c20a58c8e5"><div class="ttname"><a href="group__cpu__atmega__common.html#ga6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a></div><div class="ttdeci">#define ENOMEM</div><div class="ttdef"><b>Definition:</b> <a href="errno_8h_source.html#l00116">errno.h:116</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html_a40173d8faca4a059c9651c46d81e2d24"><div class="ttname"><a href="struct__transmission__control__block.html#a40173d8faca4a059c9651c46d81e2d24">_transmission_control_block::tim_tout</a></div><div class="ttdeci">xtimer_t tim_tout</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00070">tcb.h:70</a></div></div>
<div class="ttc" id="group__sys__xtimer_html_ga2b6666a277679ca79aaa27db957057ab"><div class="ttname"><a href="group__sys__xtimer.html#ga2b6666a277679ca79aaa27db957057ab">xtimer_remove</a></div><div class="ttdeci">void xtimer_remove(xtimer_t *timer)</div><div class="ttdoc">remove a timer </div><div class="ttdef"><b>Definition:</b> <a href="xtimer__core_8c_source.html#l00280">xtimer_core.c:280</a></div></div>
<div class="ttc" id="structgnrc__pktsnip_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="structgnrc__pktsnip.html#a735984d41155bc1032e09bece8f8d66d">gnrc_pktsnip::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="include_2net_2gnrc_2pkt_8h_source.html#l00111">pkt.h:111</a></div></div>
<div class="ttc" id="stdlib_8h_html"><div class="ttname"><a href="stdlib_8h.html">stdlib.h</a></div><div class="ttdoc">stdlib.h wrapper for MSP430 </div></div>
<div class="ttc" id="inet__csum_8h_html"><div class="ttname"><a href="inet__csum_8h.html">inet_csum.h</a></div><div class="ttdoc">Internet Checksum definitions. </div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gafb4a043089340d1fedd1195b3766853a"><div class="ttname"><a href="group__net__gnrc__tcp.html#gafb4a043089340d1fedd1195b3766853a">_pkt_build</a></div><div class="ttdeci">int _pkt_build(gnrc_tcp_tcb_t *tcb, gnrc_pktsnip_t **out_pkt, uint16_t *seq_con, const uint16_t ctl, const uint32_t seq_num, const uint32_t ack_num, void *payload, const size_t payload_len)</div><div class="ttdoc">Build and allocate a tcp paket in paketbuffer, conn stores pointer to new paket. </div><div class="ttdef"><b>Definition:</b> <a href="gnrc__tcp__pkt_8c_source.html#l00117">gnrc_tcp_pkt.c:117</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga3708b74de40b7d3d4dd7049ef7ff86f0"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga3708b74de40b7d3d4dd7049ef7ff86f0">MSK_SYN</a></div><div class="ttdeci">#define MSK_SYN</div><div class="ttdef"><b>Definition:</b> <a href="net_2gnrc_2transport__layer_2tcp_2internal_2helper_8h_source.html#l00037">helper.h:37</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_ga91e8504870ecfa53cea5d13e47d942ad"><div class="ttname"><a href="group__net__gnrc__tcp.html#ga91e8504870ecfa53cea5d13e47d942ad">GNRC_TCP_RTO_GRANULARITY</a></div><div class="ttdeci">#define GNRC_TCP_RTO_GRANULARITY</div><div class="ttdoc">Assumes clock granularity for TCP of 10 ms (see RFC 6298) </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00132">config.h:132</a></div></div>
<div class="ttc" id="group__net__gnrc__tcp_html_gaee9d9c41d5d5bdf6e27098522e976f9e"><div class="ttname"><a href="group__net__gnrc__tcp.html#gaee9d9c41d5d5bdf6e27098522e976f9e">GNRC_TCP_RTO_A_DIV</a></div><div class="ttdeci">#define GNRC_TCP_RTO_A_DIV</div><div class="ttdoc">Alpha value for RTO calculation, default is 1/8. </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00139">config.h:139</a></div></div>
<div class="ttc" id="struct__transmission__control__block_html_ab0dfae57b1299ffa70be91f07f2cbb97"><div class="ttname"><a href="struct__transmission__control__block.html#ab0dfae57b1299ffa70be91f07f2cbb97">_transmission_control_block::rto</a></div><div class="ttdeci">int32_t rto</div><div class="ttdef"><b>Definition:</b> <a href="tcb_8h_source.html#l00068">tcb.h:68</a></div></div>
<div class="ttc" id="structmsg__t_html_add9af9569af79ec26dd741fb226b38ba"><div class="ttname"><a href="structmsg__t.html#add9af9569af79ec26dd741fb226b38ba">msg_t::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="msg_8h_source.html#l00189">msg.h:189</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 15 2017 18:57:07 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
