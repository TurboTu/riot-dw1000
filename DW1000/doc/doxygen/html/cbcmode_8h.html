<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sys/include/crypto/cbcmode.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="riot-logo.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">DecaRange RTLS ARM Application</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a408b6d3a4a484720bc3ecfeac8947e3.html">sys</a></li><li class="navelem"><a class="el" href="dir_e9e107fc86bbb4b6a326076a6808b9f5.html">include</a></li><li class="navelem"><a class="el" href="dir_0ad69467a20205cef2b7e6370c6fd011.html">crypto</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a>  </div>
  <div class="headertitle">
<div class="title">cbcmode.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Headers of the implementation of the CBC Mode of Operation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="stdio_8h_source.html">stdio.h</a>&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;<a class="el" href="stdlib_8h_source.html">stdlib.h</a>&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ciphers_8h_source.html">crypto/ciphers.h</a>&quot;</code><br />
</div>
<p><a href="cbcmode_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c_b_c_mode_context.html">CBCModeContext</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The context for processing the en-/decryption in the CBC-Mode with CTS.  <a href="struct_c_b_c_mode_context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acffbd305ee72dcd4593c0d8af64a4f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbcmode_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="el" href="minstd_8c.html#a8d3c3518d793541417a4845125da1ae1">a</a>,  b)&#160;&#160;&#160;( ((<a class="el" href="minstd_8c.html#a8d3c3518d793541417a4845125da1ae1">a</a>) &lt; (b)) ? (<a class="el" href="minstd_8c.html#a8d3c3518d793541417a4845125da1ae1">a</a>) : (b))</td></tr>
<tr class="separator:a3acffbd305ee72dcd4593c0d8af64a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6cde5699bf48258ee44574db5139e49"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbcmode_8h.html#ac6cde5699bf48258ee44574db5139e49">DBG_CRYPTO</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ac6cde5699bf48258ee44574db5139e49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb508ea8227673f419e9fe3a86c30d8e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbcmode_8h.html#abb508ea8227673f419e9fe3a86c30d8e">FAIL</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:abb508ea8227673f419e9fe3a86c30d8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa90cac659d18e8ef6294c7ae337f6b58"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbcmode_8h.html#aa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:aa90cac659d18e8ef6294c7ae337f6b58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac810e3988d474e0d2f9a72074a14462a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="cbcmode_8h.html#ac810e3988d474e0d2f9a72074a14462aa386ad547d950538faa888f3b53d838a0">CBCMODE_MAX_BLOCK_SIZE</a> = 8, 
<a class="el" href="cbcmode_8h.html#ac810e3988d474e0d2f9a72074a14462aa2bc8aaa4bc53b3b1af01d6a9b811a27b">CBCMODE_MAX_BLOCK_SIZE_AES</a> = 16
 }</td></tr>
<tr class="separator:ac810e3988d474e0d2f9a72074a14462a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad678c6860635b7045d59841fa9c9ee8"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="cbcmode_8h.html#aad678c6860635b7045d59841fa9c9ee8a088036427f447a0c1f636e9de76ea97e">ONE_BLOCK</a>, 
<a class="el" href="cbcmode_8h.html#aad678c6860635b7045d59841fa9c9ee8aa965658e6a84d5502df1c1987b0a8466">GENERAL</a>, 
<a class="el" href="cbcmode_8h.html#aad678c6860635b7045d59841fa9c9ee8ab498d78eaede154f184d428adc5885a9">TWO_LEFT_A</a>, 
<a class="el" href="cbcmode_8h.html#aad678c6860635b7045d59841fa9c9ee8accf2ba564889846f75c6bbec15af566a">TWO_LEFT_B</a>
 }</td></tr>
<tr class="separator:aad678c6860635b7045d59841fa9c9ee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d0dfd1ba098362771210bb33a25d669"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_c_b_c_mode_context.html">CBCModeContext</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbcmode_8h.html#a7d0dfd1ba098362771210bb33a25d669">CBCModeContext</a></td></tr>
<tr class="memdesc:a7d0dfd1ba098362771210bb33a25d669"><td class="mdescLeft">&#160;</td><td class="mdescRight">The context for processing the en-/decryption in the CBC-Mode with CTS.  <a href="#a7d0dfd1ba098362771210bb33a25d669">More...</a><br /></td></tr>
<tr class="separator:a7d0dfd1ba098362771210bb33a25d669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa410024a7d30a4127205f45efbdffa14"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbcmode_8h.html#aa410024a7d30a4127205f45efbdffa14">block_cipher_mode_init</a> (CipherModeContext *context, uint8_t key_size, uint8_t *key)</td></tr>
<tr class="separator:aa410024a7d30a4127205f45efbdffa14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac885a037b23a03a41d8717eaadcdba89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbcmode_8h.html#ac885a037b23a03a41d8717eaadcdba89">block_cipher_mode_init0</a> (CipherModeContext *context, uint8_t key_size, uint8_t *key, uint8_t cipher_index)</td></tr>
<tr class="memdesc:ac885a037b23a03a41d8717eaadcdba89"><td class="mdescLeft">&#160;</td><td class="mdescRight">same as BlockCipherMode_init but with the possibility to specify the index of the cipher in the archive  <a href="#ac885a037b23a03a41d8717eaadcdba89">More...</a><br /></td></tr>
<tr class="separator:ac885a037b23a03a41d8717eaadcdba89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1f6ad567ad22f79d65057c69523b399"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbcmode_8h.html#ad1f6ad567ad22f79d65057c69523b399">dbg</a> (uint8_t <a class="el" href="tests_2periph__spi_2main_8c.html#a500c16f7901299002158783745bc1ab0">mode</a>, const char *format,...)</td></tr>
<tr class="memdesc:ad1f6ad567ad22f79d65057c69523b399"><td class="mdescLeft">&#160;</td><td class="mdescRight">prints the debug-messages passed by <a class="el" href="cbcmode_8h.html#aeae682ede7c7bad0c4311df89e6ba58f">dump_buffer</a>  <a href="#ad1f6ad567ad22f79d65057c69523b399">More...</a><br /></td></tr>
<tr class="separator:ad1f6ad567ad22f79d65057c69523b399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeae682ede7c7bad0c4311df89e6ba58f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbcmode_8h.html#aeae682ede7c7bad0c4311df89e6ba58f">dump_buffer</a> (char *bufName, uint8_t *buf, uint8_t <a class="el" href="multiboot_8h.html#a6d813a0f2b5281b18dea3f4cda696c33">size</a>)</td></tr>
<tr class="memdesc:aeae682ede7c7bad0c4311df89e6ba58f"><td class="mdescLeft">&#160;</td><td class="mdescRight">dumps the passed buffer to the console  <a href="#aeae682ede7c7bad0c4311df89e6ba58f">More...</a><br /></td></tr>
<tr class="separator:aeae682ede7c7bad0c4311df89e6ba58f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d94469b6e32fc0b056d293d8d123535"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbcmode_8h.html#a9d94469b6e32fc0b056d293d8d123535">block_cipher_mode_encrypt</a> (CipherModeContext *context, uint8_t *plain_blocks, uint8_t *cipher_blocks, uint16_t num_bytes, uint8_t *IV)</td></tr>
<tr class="memdesc:a9d94469b6e32fc0b056d293d8d123535"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts num_bytes of plaintext blocks (each of size blockSize) using the key from the init phase. The IV is a pointer to the initialization vector (of size equal to the blockSize) which is used to initialize the encryption. In place encryption should work provided that the plain and and cipher buffer are the same. (they may either be the same or non-overlapping. partial overlaps are not supported).  <a href="#a9d94469b6e32fc0b056d293d8d123535">More...</a><br /></td></tr>
<tr class="separator:a9d94469b6e32fc0b056d293d8d123535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3b5aeac35d35ebc2f4145b0c17ef79a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbcmode_8h.html#af3b5aeac35d35ebc2f4145b0c17ef79a">block_cipher_mode_decrypt</a> (CipherModeContext *context, uint8_t *cipher_blocks, uint8_t *plain_blocks, uint16_t num_bytes, uint8_t *IV)</td></tr>
<tr class="memdesc:af3b5aeac35d35ebc2f4145b0c17ef79a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts num_bytes of ciphertext blocks (each of size blockSize) using the key from the init phase. The IV is a pointer to the initialization vector (of size equal to the blockSize) which is used to initialize the decryption. In place decryption should work provided that the plain and and cipher buffer are the same. (they may either be the same or non-overlapping. partial overlaps are not supported).  <a href="#af3b5aeac35d35ebc2f4145b0c17ef79a">More...</a><br /></td></tr>
<tr class="separator:af3b5aeac35d35ebc2f4145b0c17ef79a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Headers of the implementation of the CBC Mode of Operation. </p>
<p>Implementation of the CBC Mode of Operation with Ciphertext-Stealing for encryption.</p>
<dl class="section author"><dt>Author</dt><dd>Freie Universitaet Berlin, Computer Systems &amp; Telematics. </dd>
<dd>
Nicolai Schmittberger <a href="#" onclick="location.href='mai'+'lto:'+'nic'+'ol'+'ai.'+'sc'+'hmi'+'tt'+'ber'+'ge'+'r@f'+'u-'+'ber'+'li'+'n.d'+'e'; return false;">nicol<span style="display: none;">.nosp@m.</span>ai.s<span style="display: none;">.nosp@m.</span>chmit<span style="display: none;">.nosp@m.</span>tber<span style="display: none;">.nosp@m.</span>ger@f<span style="display: none;">.nosp@m.</span>u-be<span style="display: none;">.nosp@m.</span>rlin.<span style="display: none;">.nosp@m.</span>de</a> </dd>
<dd>
Zakaria Kasmi <a href="#" onclick="location.href='mai'+'lto:'+'zka'+'sm'+'i@i'+'nf'+'.fu'+'-b'+'erl'+'in'+'.de'; return false;">zkasm<span style="display: none;">.nosp@m.</span>i@in<span style="display: none;">.nosp@m.</span>f.fu-<span style="display: none;">.nosp@m.</span>berl<span style="display: none;">.nosp@m.</span>in.de</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="cbcmode_8h_source.html">cbcmode.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ac6cde5699bf48258ee44574db5139e49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6cde5699bf48258ee44574db5139e49">&#9670;&nbsp;</a></span>DBG_CRYPTO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DBG_CRYPTO&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cbcmode_8h_source.html#l00040">40</a> of file <a class="el" href="cbcmode_8h_source.html">cbcmode.h</a>.</p>

</div>
</div>
<a id="abb508ea8227673f419e9fe3a86c30d8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb508ea8227673f419e9fe3a86c30d8e">&#9670;&nbsp;</a></span>FAIL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAIL&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cbcmode_8h_source.html#l00069">69</a> of file <a class="el" href="cbcmode_8h_source.html">cbcmode.h</a>.</p>

</div>
</div>
<a id="a3acffbd305ee72dcd4593c0d8af64a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3acffbd305ee72dcd4593c0d8af64a4f">&#9670;&nbsp;</a></span>MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="minstd_8c.html#a8d3c3518d793541417a4845125da1ae1">a</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;( ((<a class="el" href="minstd_8c.html#a8d3c3518d793541417a4845125da1ae1">a</a>) &lt; (b)) ? (<a class="el" href="minstd_8c.html#a8d3c3518d793541417a4845125da1ae1">a</a>) : (b))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cbcmode_8h_source.html#l00038">38</a> of file <a class="el" href="cbcmode_8h_source.html">cbcmode.h</a>.</p>

</div>
</div>
<a id="aa90cac659d18e8ef6294c7ae337f6b58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa90cac659d18e8ef6294c7ae337f6b58">&#9670;&nbsp;</a></span>SUCCESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SUCCESS&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cbcmode_8h_source.html#l00070">70</a> of file <a class="el" href="cbcmode_8h_source.html">cbcmode.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a7d0dfd1ba098362771210bb33a25d669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d0dfd1ba098362771210bb33a25d669">&#9670;&nbsp;</a></span>CBCModeContext</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_c_b_c_mode_context.html">CBCModeContext</a>  <a class="el" href="struct_c_b_c_mode_context.html">CBCModeContext</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The context for processing the en-/decryption in the CBC-Mode with CTS. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spill1</td><td>test1 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ac810e3988d474e0d2f9a72074a14462a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac810e3988d474e0d2f9a72074a14462a">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ac810e3988d474e0d2f9a72074a14462aa386ad547d950538faa888f3b53d838a0"></a>CBCMODE_MAX_BLOCK_SIZE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac810e3988d474e0d2f9a72074a14462aa2bc8aaa4bc53b3b1af01d6a9b811a27b"></a>CBCMODE_MAX_BLOCK_SIZE_AES&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="cbcmode_8h_source.html#l00043">43</a> of file <a class="el" href="cbcmode_8h_source.html">cbcmode.h</a>.</p>

</div>
</div>
<a id="aad678c6860635b7045d59841fa9c9ee8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad678c6860635b7045d59841fa9c9ee8">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aad678c6860635b7045d59841fa9c9ee8a088036427f447a0c1f636e9de76ea97e"></a>ONE_BLOCK&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aad678c6860635b7045d59841fa9c9ee8aa965658e6a84d5502df1c1987b0a8466"></a>GENERAL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aad678c6860635b7045d59841fa9c9ee8ab498d78eaede154f184d428adc5885a9"></a>TWO_LEFT_A&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aad678c6860635b7045d59841fa9c9ee8accf2ba564889846f75c6bbec15af566a"></a>TWO_LEFT_B&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="cbcmode_8h_source.html#l00062">62</a> of file <a class="el" href="cbcmode_8h_source.html">cbcmode.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="af3b5aeac35d35ebc2f4145b0c17ef79a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3b5aeac35d35ebc2f4145b0c17ef79a">&#9670;&nbsp;</a></span>block_cipher_mode_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int block_cipher_mode_decrypt </td>
          <td>(</td>
          <td class="paramtype">CipherModeContext *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher_blocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plain_blocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>num_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>IV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts num_bytes of ciphertext blocks (each of size blockSize) using the key from the init phase. The IV is a pointer to the initialization vector (of size equal to the blockSize) which is used to initialize the decryption. In place decryption should work provided that the plain and and cipher buffer are the same. (they may either be the same or non-overlapping. partial overlaps are not supported). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>context object for this decryption </td></tr>
    <tr><td class="paramname">cipher_blocks</td><td>an array of num_bytes * blockSize bytes that holds the cipher text </td></tr>
    <tr><td class="paramname">plain_blocks</td><td>an array of num_bytes * blockSize bytes to hold the resulting plaintext. </td></tr>
    <tr><td class="paramname">num_bytes</td><td>number of data blocks to encrypt </td></tr>
    <tr><td class="paramname">IV</td><td>an array of the initialization vector. It should be of block size bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the decryption was successful. Possible failure reasons include not calling <a class="el" href="pseudoterm_8c.html#a05848de25ac2dbec233935058a1d24b4">init()</a>. </dd></dl>

</div>
</div>
<a id="a9d94469b6e32fc0b056d293d8d123535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d94469b6e32fc0b056d293d8d123535">&#9670;&nbsp;</a></span>block_cipher_mode_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int block_cipher_mode_encrypt </td>
          <td>(</td>
          <td class="paramtype">CipherModeContext *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plain_blocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher_blocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>num_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>IV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts num_bytes of plaintext blocks (each of size blockSize) using the key from the init phase. The IV is a pointer to the initialization vector (of size equal to the blockSize) which is used to initialize the encryption. In place encryption should work provided that the plain and and cipher buffer are the same. (they may either be the same or non-overlapping. partial overlaps are not supported). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>context object for this encryption </td></tr>
    <tr><td class="paramname">plain_blocks</td><td>a plaintext block numBlocks, where each block is of blockSize bytes </td></tr>
    <tr><td class="paramname">cipher_blocks</td><td>an array of numBlocks * blockSize bytes to hold the resulting cyphertext </td></tr>
    <tr><td class="paramname">num_bytes</td><td>number of data blocks to encrypt </td></tr>
    <tr><td class="paramname">IV</td><td>an array of the initialization vector. It should be of block size bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the encryption was successful. Possible failure reasons include not calling <a class="el" href="pseudoterm_8c.html#a05848de25ac2dbec233935058a1d24b4">init()</a>. </dd></dl>

</div>
</div>
<a id="aa410024a7d30a4127205f45efbdffa14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa410024a7d30a4127205f45efbdffa14">&#9670;&nbsp;</a></span>block_cipher_mode_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int block_cipher_mode_init </td>
          <td>(</td>
          <td class="paramtype">CipherModeContext *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>key_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac885a037b23a03a41d8717eaadcdba89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac885a037b23a03a41d8717eaadcdba89">&#9670;&nbsp;</a></span>block_cipher_mode_init0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int block_cipher_mode_init0 </td>
          <td>(</td>
          <td class="paramtype">CipherModeContext *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>key_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>cipher_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>same as BlockCipherMode_init but with the possibility to specify the index of the cipher in the archive </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>structure to hold the opaque data from this initialization call. It should be passed to future invocations of this module which use this particular key. It also contains the opaque context for the underlying BlockCipher as well. </td></tr>
    <tr><td class="paramname">key_size</td><td>key size in bytes. </td></tr>
    <tr><td class="paramname">key</td><td>pointer to the key. </td></tr>
    <tr><td class="paramname">cipher_index</td><td>the index of the cipher-algorithm to init in the (cipher-)archive</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether initialization was successful. The command may be unsuccessful if the key size is not valid for the given cipher implementation. It can also fail if the preferred block size of the cipher does not agree with the preferred size of the mode. </dd></dl>

</div>
</div>
<a id="ad1f6ad567ad22f79d65057c69523b399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1f6ad567ad22f79d65057c69523b399">&#9670;&nbsp;</a></span>dbg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dbg </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>prints the debug-messages passed by <a class="el" href="cbcmode_8h.html#aeae682ede7c7bad0c4311df89e6ba58f">dump_buffer</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mode</td><td>the mode of the debug-message </td></tr>
    <tr><td class="paramname">format</td><td>pointer to the message </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aeae682ede7c7bad0c4311df89e6ba58f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeae682ede7c7bad0c4311df89e6ba58f">&#9670;&nbsp;</a></span>dump_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dump_buffer </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>bufName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dumps the passed buffer to the console </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bufName</td><td>pointer to the name of the buffer </td></tr>
    <tr><td class="paramname">buf</td><td>pointer to the buffer itself </td></tr>
    <tr><td class="paramname">size</td><td>the size of the buffer in bytes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 15 2017 18:57:34 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
