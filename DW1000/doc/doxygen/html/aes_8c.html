<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sys/crypto/aes.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="riot-logo.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">DecaRange RTLS ARM Application</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a408b6d3a4a484720bc3ecfeac8947e3.html">sys</a></li><li class="navelem"><a class="el" href="dir_8be449c6bbc520801387072f402ecf1c.html">crypto</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">aes.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>implementation of the AES cipher-algorithm  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="stdio_8h_source.html">stdio.h</a>&gt;</code><br />
<code>#include &lt;stdarg.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;<a class="el" href="stdlib_8h_source.html">stdlib.h</a>&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="sys_2include_2crypto_2aes_8h_source.html">crypto/aes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ciphers_8h_source.html">crypto/ciphers.h</a>&quot;</code><br />
</div>
<p><a href="aes_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a092a68bd27b17ccf4280586b1cadb8af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a092a68bd27b17ccf4280586b1cadb8af">aes_init</a> (<a class="el" href="structcipher__context__t.html">cipher_context_t</a> *context, const uint8_t *key, uint8_t keySize)</td></tr>
<tr class="memdesc:a092a68bd27b17ccf4280586b1cadb8af"><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes the AES Cipher-algorithm with the passed parameters  <a href="#a092a68bd27b17ccf4280586b1cadb8af">More...</a><br /></td></tr>
<tr class="separator:a092a68bd27b17ccf4280586b1cadb8af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e1a09984474017b0b4781f4c356a584"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a9e1a09984474017b0b4781f4c356a584">aes_encrypt</a> (const <a class="el" href="structcipher__context__t.html">cipher_context_t</a> *context, const uint8_t *plainBlock, uint8_t *cipherBlock)</td></tr>
<tr class="memdesc:a9e1a09984474017b0b4781f4c356a584"><td class="mdescLeft">&#160;</td><td class="mdescRight">encrypts one plainBlock-block and saves the result in cipherblock. encrypts one blocksize long block of plaintext pointed to by plainBlock to one blocksize long block of ciphertext which will be written to the the memory-area pointed to by cipherBlock  <a href="#a9e1a09984474017b0b4781f4c356a584">More...</a><br /></td></tr>
<tr class="separator:a9e1a09984474017b0b4781f4c356a584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14ffdf63e10bb06f1e3a9c52a69e0453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a14ffdf63e10bb06f1e3a9c52a69e0453">aes_decrypt</a> (const <a class="el" href="structcipher__context__t.html">cipher_context_t</a> *context, const uint8_t *cipherBlock, uint8_t *plainBlock)</td></tr>
<tr class="memdesc:a14ffdf63e10bb06f1e3a9c52a69e0453"><td class="mdescLeft">&#160;</td><td class="mdescRight">decrypts one cipher-block and saves the plain-block in plainBlock. decrypts one blocksize long block of ciphertext pointed to by cipherBlock to one blocksize long block of plaintext and stores the plaintext in the memory-area pointed to by plainBlock  <a href="#a14ffdf63e10bb06f1e3a9c52a69e0453">More...</a><br /></td></tr>
<tr class="separator:a14ffdf63e10bb06f1e3a9c52a69e0453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa81f3d9e00fbed6ba666d11781274265"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ciphers_8h.html#af8e67bf62296bb7517d132e3a9e20416">cipher_id_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#aa81f3d9e00fbed6ba666d11781274265">CIPHER_AES_128</a> = &amp;aes_interface</td></tr>
<tr class="separator:aa81f3d9e00fbed6ba666d11781274265"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>implementation of the AES cipher-algorithm </p>
<dl class="section author"><dt>Author</dt><dd>Freie Universitaet Berlin, Computer Systems &amp; Telematics </dd>
<dd>
Nicolai Schmittberger <a href="#" onclick="location.href='mai'+'lto:'+'nic'+'ol'+'ai.'+'sc'+'hmi'+'tt'+'ber'+'ge'+'r@f'+'u-'+'ber'+'li'+'n.d'+'e'; return false;">nicol<span style="display: none;">.nosp@m.</span>ai.s<span style="display: none;">.nosp@m.</span>chmit<span style="display: none;">.nosp@m.</span>tber<span style="display: none;">.nosp@m.</span>ger@f<span style="display: none;">.nosp@m.</span>u-be<span style="display: none;">.nosp@m.</span>rlin.<span style="display: none;">.nosp@m.</span>de</a> </dd>
<dd>
Fabrice Bellard </dd>
<dd>
Zakaria Kasmi <a href="#" onclick="location.href='mai'+'lto:'+'zka'+'sm'+'i@i'+'nf'+'.fu'+'-b'+'erl'+'in'+'.de'; return false;">zkasm<span style="display: none;">.nosp@m.</span>i@in<span style="display: none;">.nosp@m.</span>f.fu-<span style="display: none;">.nosp@m.</span>berl<span style="display: none;">.nosp@m.</span>in.de</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Integrated in QEMU by Fabrice Bellard from the OpenSSL project. </dd></dl>
<dl class="section version"><dt>Version</dt><dd>3.0 (December 2000). Optimised ANSI C code for the Rijndael cipher (now AES).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Vincent Rijmen <a href="#" onclick="location.href='mai'+'lto:'+'vin'+'ce'+'nt.'+'ri'+'jme'+'n@'+'esa'+'t.'+'kul'+'eu'+'ven'+'.a'+'c.b'+'e'; return false;">vince<span style="display: none;">.nosp@m.</span>nt.r<span style="display: none;">.nosp@m.</span>ijmen<span style="display: none;">.nosp@m.</span>@esa<span style="display: none;">.nosp@m.</span>t.kul<span style="display: none;">.nosp@m.</span>euve<span style="display: none;">.nosp@m.</span>n.ac.<span style="display: none;">.nosp@m.</span>be</a> </dd>
<dd>
Antoon Bosselaers <a href="#" onclick="location.href='mai'+'lto:'+'ant'+'oo'+'n.b'+'os'+'sel'+'ae'+'rs@'+'es'+'at.'+'ku'+'leu'+'ve'+'n.a'+'c.'+'be'; return false;">antoo<span style="display: none;">.nosp@m.</span>n.bo<span style="display: none;">.nosp@m.</span>ssela<span style="display: none;">.nosp@m.</span>ers@<span style="display: none;">.nosp@m.</span>esat.<span style="display: none;">.nosp@m.</span>kule<span style="display: none;">.nosp@m.</span>uven.<span style="display: none;">.nosp@m.</span>ac.b<span style="display: none;">.nosp@m.</span>e</a> </dd>
<dd>
Paulo Barreto <a href="#" onclick="location.href='mai'+'lto:'+'pau'+'lo'+'.ba'+'rr'+'eto'+'@t'+'err'+'a.'+'com'+'.b'+'r'; return false;">paulo<span style="display: none;">.nosp@m.</span>.bar<span style="display: none;">.nosp@m.</span>reto@<span style="display: none;">.nosp@m.</span>terr<span style="display: none;">.nosp@m.</span>a.com<span style="display: none;">.nosp@m.</span>.br</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a14ffdf63e10bb06f1e3a9c52a69e0453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14ffdf63e10bb06f1e3a9c52a69e0453">&#9670;&nbsp;</a></span>aes_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aes_decrypt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcipher__context__t.html">cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>cipher_block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plain_block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>decrypts one cipher-block and saves the plain-block in plainBlock. decrypts one blocksize long block of ciphertext pointed to by cipherBlock to one blocksize long block of plaintext and stores the plaintext in the memory-area pointed to by plainBlock </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>the cipher_context_t-struct to use for this decryption </td></tr>
    <tr><td class="paramname">cipher_block</td><td>a pointer to the ciphertext-block (of size blocksize) to be decrypted </td></tr>
    <tr><td class="paramname">plain_block</td><td>a pointer to the place where the decrypted plaintext will be stored</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 or negative value if cipher key cannot be expanded into decryption key schedule </dd></dl>

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l01198">1198</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>

</div>
</div>
<a id="a9e1a09984474017b0b4781f4c356a584"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e1a09984474017b0b4781f4c356a584">&#9670;&nbsp;</a></span>aes_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aes_encrypt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcipher__context__t.html">cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plain_block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher_block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>encrypts one plainBlock-block and saves the result in cipherblock. encrypts one blocksize long block of plaintext pointed to by plainBlock to one blocksize long block of ciphertext which will be written to the the memory-area pointed to by cipherBlock </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>the cipher_context_t-struct to use for this encryption </td></tr>
    <tr><td class="paramname">plain_block</td><td>a pointer to the plaintext-block (of size blocksize) </td></tr>
    <tr><td class="paramname">cipher_block</td><td>a pointer to the place where the ciphertext will be stored</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 or result of aes_set_encrypt_key if it failed </dd></dl>

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00939">939</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>

</div>
</div>
<a id="a092a68bd27b17ccf4280586b1cadb8af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a092a68bd27b17ccf4280586b1cadb8af">&#9670;&nbsp;</a></span>aes_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aes_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcipher__context__t.html">cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>keySize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initializes the AES Cipher-algorithm with the passed parameters </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>the cipher_context_t-struct to save the initialization of the cipher in </td></tr>
    <tr><td class="paramname">keySize</td><td>the size of the key </td></tr>
    <tr><td class="paramname">key</td><td>a pointer to the key</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CIPHER_INIT_SUCCESS if the initialization was successful. The command may be unsuccessful if the key size is not valid. CIPHER_ERR_BAD_CONTEXT_SIZE if CIPHER_MAX_CONTEXT_SIZE has not been defined (which means that the cipher has not been included in the build) </dd></dl>

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00723">723</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa81f3d9e00fbed6ba666d11781274265"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa81f3d9e00fbed6ba666d11781274265">&#9670;&nbsp;</a></span>CIPHER_AES_128</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ciphers_8h.html#af8e67bf62296bb7517d132e3a9e20416">cipher_id_t</a> CIPHER_AES_128 = &amp;aes_interface</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00050">50</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 15 2017 18:57:34 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
